{"compress":true,"commitItems":[["798a290e-d092-4f68-9cfc-708bd655ca61",1520327512243,"",[[1520327497298,["fangle@fangle-PC",[[1,0,"#### 引用变量\n在PHP中引用意味着用不同名字访问同一个变量的内容\n> 引用的本质是别名而不是指针\n\n思考：\n```\n<?php\n$a = range(0,100);\n$b = $a;\n```\n此时$a 与 $b 指向的是同一块内存空间吗？\n是的。PHP有一个机制叫做COW机制，也就是Copy On write 。只有$a 或 $b 发生写操作时，才会开辟一块新的空间，$a和$b 才指向不同的内存块。\n证明：\n```\n$a = range(0,100);\nvar_dump(memory_get_usage());\n\n$b = $a;\nvar_dump(memory_get_usage());\n\n$a = range(0,100);\nvar_dump(memory_get_usage());\n```\n使用引用的话，就不会触发写时复制机制\n```\n<?php\n$a = range(0,100);\nvar_dump(memory_get_usage());\n\n$b = &$a;\nvar_dump(memory_get_usage());\n\n$a = range(0,100);\nvar_dump(memory_get_usage());\n```\n\n#### zval 结构体\nPHP的变量都是基于zval结构体的,也就是说zval是PHP变量的容器\n```\n<?php\n$a = range(0,100);\nxdebug_debug_zval('a');\n\n$b = $a;\nxdebug_debug_zval('a');\n\n$a = range(0,100);\nxdebug_debug_zval('a');\n```\n\n#### unset()与引用\n> unset 只会取消引用不会销毁内存空间\n\n```\n<?php\n$a = 1;\n$b = &$a;\nunset($b);\necho $a;\n```\n\n#### 对象与引用\n> 在PHP中，对象默认的传值方式是引用而不是赋值。所以，不用加&。\n\n```\n<?php\nclass Person\n{\n    public $name;    \n}\n\n$p1 = new Person();\nxdebug_debug_zval('p1');\n\n$p2 = p1;\nxdebug_debug_zval('p1');\n\n$p2->name = 'fangle';\nxdebug_debug_zval('p1');\n```\n\n#### 面试题\n```\n<?php\n$data = ['a','b','c'];\n\nforeach($data as $key => $val){\n    $val = &$data[$key];\n}\n//每一次循环结束后$data的值是什么?\n```\n解答\n```\n$key = 0\n$val = a\n$val = &$data[0] = a\n\n$key = 1\n$val = b => $data[0]=b\n$val = &$data[1] = b\n\n$key = 2\n$val = c => $data[1] = c\n$val = &$data[2] = c\n\n所以\n$data = ['b','c','c'];\n```\n> 谨慎foreach中使用引用带来的影响\n\n```\n$test = ['a','b','c'];\nforeach($test as &$value){  \n     echo $value;  \n} \n\n$num = [1,2,3]\nforeach($num as $value){  \n     echo $value;  \n}  \n```"]],[0,0],[1528,1528]]],[1520327521820,["fangle@fangle-PC",[[-1,105," "]],[106,106],[105,105]]],[1520327523808,["fangle@fangle-PC",[[1,105," "]],[105,105],[106,106]]],[1520327530299,["fangle@fangle-PC",[[-1,108," "]],[109,109],[108,108]]],[1520327532628,["fangle@fangle-PC",[[1,108," "]],[108,108],[109,109]]]]]]}