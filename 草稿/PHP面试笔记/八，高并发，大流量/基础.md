### 面试题
php 如何解决网站大流量和高并发的问题

考点：
- 高并发架构的相关概念
- 高并发解决方案案例


### 高并发概念
同一时间点有多个用户同时访问

如果一个系统的日PV在千万以上就有可能是一个高并发系统

- pv 
PV(page view)，即页面浏览量；用户每1次对网站中的每个网页访问均被记录1次。用户对同一页面的多次访问，访问量累计。
- uv
uv(unique visitor)，指访问某个站点或点击某条新闻的不同IP地址的人数。
在同一天内，uv只记录第一次进入网站的具有独立IP的访问者，在同一天内再次访问该网站则不计数。独立IP访问者提供了一定时间内不同观众数量的统计指标，而没有反应出网站的全面活动
- QPS
QPS(Query Per Second),每秒查询率QPS是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。 在互联网中指每秒响应的请求数
- 吞吐量（tps）
单位时间内处理的请求数量（通常由qps与并发数确定）

QPS 不等于并发连接数，QPS指的是每秒的Http请求，并发连接数是指系统同时处理的连接数量

### 压力测试
常用的性能测试工具
ab, wrk,http_load,web bench, siege 

#### ab 使用
模拟并发请求100次，总共请求5000次
ab -c 100 -n 5000 url 

- 测试的机器与被测试的机器分开
- 不要对线上服务做压测
- 观察测试工具 ab 所在的服务器，以及被测试前端机的CPU，内存和网络都不超过最高限度的75%

QPS 达到50 小型网站
达到100 

高并发解决方案

静态缓存

#### 流量优化 
- 资源防盗链
- CDN加速
- 建立独立的图片服务器

#### 前端优化
- 减少Http请求，css合并 js 合并，图片合并
- 使用异步请求 
- 启用浏览器缓存和文件压缩

#### 服务端优化
- 页面静态化，直接缓存为html文件
- 并发处理，swoole，kafka队列

#### 数据库优化
- redis 缓存
- mysql 缓存
- 分库 分表，分区操作 避免锁表
- 读写分离

#### 架构
- LVS 负载均衡