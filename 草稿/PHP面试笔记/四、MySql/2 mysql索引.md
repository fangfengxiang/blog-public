2 mysql索引
===

### 面试题
简单描述MYSQL中，索引，主键，唯一索引，联合索引的区别，对数据库的性能有什么影响？
创建mysql复合索引时应该注意哪些事项？（答案：遵循前缀原则）

### 考点
- mysql索引的基础和类型
- mysql索引的创建原则
- mysql索引的注意事项

### 索引的基础
> 索引类似于书籍的目录，要想找到一本书的某个特定主题，需要先查找书的目录，定位对应的页码

存储引擎使用类似的方式进行数据查询，先去索引当中找到对应的值，然后根据匹配的索引找到对应的数据行

#### 索引对性能的影响
- 大大减少数据库需要扫描的数据量，提升查询效率
- 帮助服务器避免排序和临时表
- 将随机IO变成顺序IO 
- 降低写的速度（写的过程要重新操作一下索引）
- 占用磁盘空间

#### 使用场景 
对于非常小的表，大部分情况下全表扫描效率更高
中大型表，索引非常有效
特大型表，建立和使用索引的代价随之增长，可以使用分区技术来实现

#### 索引的类型
-  普通索引
最基本的索引，没有任何的约束限制
- 唯一索引
与普通索引类似，但是具有唯一性限制
- 主键索引
特殊的唯一索引，不允许有空值
一个表中，只能有一个主键索引，可以有多个唯一索引
主键可以和外键构成参照完整性约束，防止数据不一致
- 组合索引
将多个列组合在一起创建索引，可以覆盖多个列	
- 外键索引
只有Innodb才可以使用外键索引，保证数据的一致性，完整性和实现级联操作
- 全文索引
mysql自带的全文索引只能用于myisam，并且只能对英文进行全文索引

#### 索引的创建原则
- 最应该使用索引的列应该是出现在where子句中的列，或连接字句中的列，而不是出现在select关键字后的列
- 索引列的基数越大，索引的效果越好
- 对字符串进行索引，应该制定一个前缀长度，可以节省大量的索引空间
- 根据情况创建联合索引，复合索引可以提高查询效率
- 避免创建过多的索引，索引会额外占用磁盘空间，减低写操作效率
- 主键尽可能选择较短的数据类型，可以有效减少索引的磁盘占用提高查询效率

#### 索引的注意事项
- 复合索引遵循前缀原则
```
key(a,b,c)
where a=1 and b=2 and c=3
where a=1 and b=2
where a=1
//前缀原则只有上面三种查询索引能生效
```
- like查询，%不在前面，可以使用全文索引
- column is null 也能使用索引
- 如果mysql估计使用索引比全局扫描还慢时，会放弃索引
- 如果or前的条件有索引，后面的没有，那么索引都不会被用到
- 列类型是字符串类型，查询时一定要加引号，否则索引失效

